name: Random Daily Commits

on:
  schedule:
    # Multiple times per day to create random commits
    - cron: "0 6 * * *"   # 6 AM UTC
    - cron: "0 12 * * *"  # 12 PM UTC  
    - cron: "0 18 * * *"  # 6 PM UTC
    - cron: "0 22 * * *"  # 10 PM UTC
  workflow_dispatch:      # Allow manual runs

jobs:
  random-commits:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Configure Git
        run: |
          git config --local user.email "41898282+github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"

      - name: Generate random commits
        run: |
          # Random number of commits (2-7)
          NUM_COMMITS=$((RANDOM % 6 + 2))
          echo "Creating $NUM_COMMITS commits today"
          
          # Array of commit messages
          MESSAGES=(
            "📝 Daily progress update"
            "🚀 Feature improvements"
            "🐛 Bug fixes and optimizations"
            "📊 Data updates"
            "🔧 Configuration changes"
            "✨ Code enhancements"
            "📈 Performance improvements"
            "🎯 Goal tracking update"
            "💡 New ideas implemented"
            "🔄 Routine maintenance"
          )
          
          # Array of file activities
          ACTIVITIES=(
            "progress"
            "notes"
            "ideas"
            "tasks"
            "goals"
            "metrics"
            "changelog"
            "updates"
          )
          
          for i in $(seq 1 $NUM_COMMITS); do
            # Random delay between commits (0-30 minutes)
            if [ $i -gt 1 ]; then
              DELAY=$((RANDOM % 1800))
              echo "Waiting $DELAY seconds before next commit..."
              sleep $DELAY
            fi
            
            # Pick random message and activity
            MSG_INDEX=$((RANDOM % ${#MESSAGES[@]}))
            ACT_INDEX=$((RANDOM % ${#ACTIVITIES[@]}))
            MESSAGE="${MESSAGES[$MSG_INDEX]}"
            ACTIVITY="${ACTIVITIES[$ACT_INDEX]}"
            
            # Create/update random file
            FILENAME="${ACTIVITY}-$(date +%Y%m%d).md"
            TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S UTC')
            
            # Add content to file
            echo "## Update #$i - $TIMESTAMP" >> "$FILENAME"
            echo "" >> "$FILENAME"
            echo "- Status: Active" >> "$FILENAME"
            echo "- Commit: $i of $NUM_COMMITS" >> "$FILENAME"
            echo "- Random value: $RANDOM" >> "$FILENAME"
            echo "" >> "$FILENAME"
            
            # Also update main activity log
            echo "$TIMESTAMP - $MESSAGE (commit $i/$NUM_COMMITS)" >> daily-activity.log
            
            # Commit changes
            git add .
            git commit -m "$MESSAGE - Update $i/$NUM_COMMITS" || echo "Nothing to commit"
            
            echo "Commit $i completed"
          done

      - name: Push all commits
        run: |
          git push origin main || git push origin master
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Cleanup old files (optional)
        run: |
          # Remove files older than 30 days to keep repo clean
          find . -name "*.md" -type f -mtime +30 -delete 2>/dev/null || true
          if [ -n "$(git status --porcelain)" ]; then
            git add .
            git commit -m "🧹 Cleanup old files" || echo "Nothing to cleanup"
            git push origin main || git push origin master
          fi
